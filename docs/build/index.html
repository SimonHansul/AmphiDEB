<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>AmphiDEB.jl · AmphiDEB</title><meta name="title" content="AmphiDEB.jl · AmphiDEB"/><meta property="og:title" content="AmphiDEB.jl · AmphiDEB"/><meta property="twitter:title" content="AmphiDEB.jl · AmphiDEB"/><meta name="description" content="Documentation for AmphiDEB."/><meta property="og:description" content="Documentation for AmphiDEB."/><meta property="twitter:description" content="Documentation for AmphiDEB."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>AmphiDEB</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>AmphiDEB.jl</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Notes-on-notation-and-terminology"><span>Notes on notation and terminology</span></a></li><li><a class="tocitem" href="#Input-parameters"><span>Input parameters</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>AmphiDEB.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>AmphiDEB.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SimonHansul/AmphiDEB" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SimonHansul/AmphiDEB/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="AmphiDEB.jl"><a class="docs-heading-anchor" href="#AmphiDEB.jl">AmphiDEB.jl</a><a id="AmphiDEB.jl-1"></a><a class="docs-heading-anchor-permalink" href="#AmphiDEB.jl" title="Permalink"></a></h1><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>AmphiDEB depends on <code>EcotoxSystems.jl</code>, which is curently not registered.  Installation thus requires</p><pre><code class="language-Julia hljs">using Pkg
Pkg.add(url=&quot;htts://github.com/simonhansul/EcotoxSystems.jl&quot;)
Pkg.add(url=&quot;htts://github.com/simonhansul/AmphiDEB&quot;)</code></pre><p>Guided examples are given in the <a href="https://github.com/SimonHansul/AmphiDEB/tree/main/examples">examples directory</a>.</p><h2 id="Notes-on-notation-and-terminology"><a class="docs-heading-anchor" href="#Notes-on-notation-and-terminology">Notes on notation and terminology</a><a id="Notes-on-notation-and-terminology-1"></a><a class="docs-heading-anchor-permalink" href="#Notes-on-notation-and-terminology" title="Permalink"></a></h2><h3 id="Simplified-DEB-notation"><a class="docs-heading-anchor" href="#Simplified-DEB-notation">Simplified DEB notation</a><a id="Simplified-DEB-notation-1"></a><a class="docs-heading-anchor-permalink" href="#Simplified-DEB-notation" title="Permalink"></a></h3><p>For DEB-TKTD parameters and state variables,  we use a slightly simplified notation, following these rules:</p><ul><li>Leading capitalized character indicates a state variable<ul><li><code>X</code>: External resource</li><li><code>X_emb</code>: Embryonic buffer</li><li><code>I</code>: Ingested resource</li><li><code>A</code>: Assimilates</li><li><code>M</code>: Somatic maintenance costs</li><li><code>H</code>: Maturity</li><li><code>J</code>: Maturity maintenance costs</li><li><code>R</code>: Reproduction buffer</li></ul></li><li><code>k_X</code> is a rate constant related to state variable <code>X</code></li><li><code>eta_XY</code> is the efficiency of transforming <code>X</code> into <code>Y</code></li><li><code>X_int</code> is the initial value of <code>X</code></li><li><code>y_X</code> indicates the response to <code>X</code> (e.g. chemical stressor or temperature). The relative response is <em>always</em> defined as a value that can be multiplied with the relevant term in the derivatives without further transformation.</li></ul><p>Furthermore, surface areas and volumes are only given up to a proportionality:</p><ul><li>surface area <span>$\propto$</span> mass <span>$^{2/3}$</span></li><li>volume <span>$\propto$</span> mass</li></ul><p>The zoom factor is based on the maximum structural masses of individuals.</p><h3 id="Life-stage-specificity"><a class="docs-heading-anchor" href="#Life-stage-specificity">Life stage specificity</a><a id="Life-stage-specificity-1"></a><a class="docs-heading-anchor-permalink" href="#Life-stage-specificity" title="Permalink"></a></h3><p>Some parameters are life stage specific, indicated by suffixes <code>_emb</code>, <code>_lrv</code>, <code>_mt</code>, <code>_juv</code>, <code>_ad</code>. &lt;br&gt; The suffix indicates the life stage for which a switch in the value occurrs. &lt;br&gt; For example, we have values <code>k_M_emb</code> and <code>k_M_juv</code>, which means that <code>k_M</code> has the value <code>k_M_emb</code> for embryos, larvae and metamorphs,  and value <code>k_M_juv</code> for juveniles and adults.</p><h2 id="Input-parameters"><a class="docs-heading-anchor" href="#Input-parameters">Input parameters</a><a id="Input-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Input-parameters" title="Permalink"></a></h2><p>Listed below are the input parameters of the model (valid for v0.3.3). &lt;br&gt;  For guidance on how to use these, please consult the examples. &lt;br&gt; Please note that the default parameters are largely arbitrary and do not reflect a particular species.</p><h3 id="Global-(glb)"><a class="docs-heading-anchor" href="#Global-(glb)">Global (<code>glb</code>)</a><a id="Global-(glb)-1"></a><a class="docs-heading-anchor-permalink" href="#Global-(glb)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Default value</th><th style="text-align: right">Comment</th></tr><tr><td style="text-align: right">t_max</td><td style="text-align: right"><code>56.</code></td><td style="text-align: right">Maximum simulation time</td></tr><tr><td style="text-align: right">N0</td><td style="text-align: right"><code>1.</code></td><td style="text-align: right">Number of starting individuals</td></tr><tr><td style="text-align: right">dX_in</td><td style="text-align: right"><code>[20., 20.]</code></td><td style="text-align: right">Food input rate [mg d⁻¹], assuming <em>ad libitum</em> feeding</td></tr><tr><td style="text-align: right">k_V</td><td style="text-align: right"><code>[0., 0.]</code></td><td style="text-align: right">Dilution rate in the aquatic medium[d⁻¹]</td></tr><tr><td style="text-align: right">V_patch</td><td style="text-align: right"><code>[1., 1.]</code></td><td style="text-align: right">Simulated volume and surface area of the aquatic and terrestic habitat, respectively</td></tr><tr><td style="text-align: right">T</td><td style="text-align: right"><code>293.15</code></td><td style="text-align: right">Ambient temperature [K]</td></tr><tr><td style="text-align: right">C_W</td><td style="text-align: right"><code>[0.;]</code></td><td style="text-align: right">Exposure concentrations (matrix: treatments × compounds)</td></tr><tr><td style="text-align: right">pathogen<em>inoculation</em>dose</td><td style="text-align: right"><code>0.</code></td><td style="text-align: right">Pathogen spores added to medium [# spores]</td></tr><tr><td style="text-align: right">pathogen<em>inoculation</em>time</td><td style="text-align: right"><code>30.</code></td><td style="text-align: right">Time-point of pathogen inoculation [t]</td></tr><tr><td style="text-align: right">medium_renewals</td><td style="text-align: right"><code>[0.]</code></td><td style="text-align: right">Time-points for media renewals (removes spores)</td></tr></table><h3 id="Species-specific-(spc)"><a class="docs-heading-anchor" href="#Species-specific-(spc)">Species-specific (<code>spc</code>)</a><a id="Species-specific-(spc)-1"></a><a class="docs-heading-anchor-permalink" href="#Species-specific-(spc)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Default value</th><th style="text-align: right">Comment</th></tr><tr><td style="text-align: right"><strong>Metaparameters</strong></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">Z</td><td style="text-align: right"><code>Dirac(1.)</code></td><td style="text-align: right">zoom factor, based on maximum structural masses</td></tr><tr><td style="text-align: right">propagate.zoom.dI<em>max</em>emb</td><td style="text-align: right"><code>1/3</code></td><td style="text-align: right">dI ∝ Z^(1/3)</td></tr><tr><td style="text-align: right">propagate.zoom.dI<em>max</em>lrv</td><td style="text-align: right"><code>1/3</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">propagate.zoom.dI<em>max</em>juv</td><td style="text-align: right"><code>1/3</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">propagate.zoom.X<em>emb</em>int</td><td style="text-align: right"><code>1.</code></td><td style="text-align: right">X_emb ∝ Z</td></tr><tr><td style="text-align: right">propagate.zoom.H_j1</td><td style="text-align: right"><code>1.</code></td><td style="text-align: right">H ∝ Z</td></tr><tr><td style="text-align: right">propagate.zoom.H_p</td><td style="text-align: right"><code>1.</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">propagate.zoom.K<em>X</em>lrv</td><td style="text-align: right"><code>1/3</code></td><td style="text-align: right">K_X ∝ dI ∝ Z^(1/3)</td></tr><tr><td style="text-align: right">propagate.zoom.K<em>X</em>juv</td><td style="text-align: right"><code>1/3</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><strong>Physiological baseline (DEB)</strong></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">X<em>emb</em>int</td><td style="text-align: right"><code>1</code></td><td style="text-align: right">Initial vitellus (≈ dry mass of an egg)</td></tr><tr><td style="text-align: right">K<em>X</em>lrv</td><td style="text-align: right"><code>1.</code></td><td style="text-align: right">Larval half-saturation constant for food uptake</td></tr><tr><td style="text-align: right">K<em>X</em>juv</td><td style="text-align: right"><code>1.</code></td><td style="text-align: right">Juvenile/adult half-saturation constant for food uptake</td></tr><tr><td style="text-align: right">dI<em>max</em>emb</td><td style="text-align: right"><code>1</code></td><td style="text-align: right">Embryonic maximum specific ingestion rate</td></tr><tr><td style="text-align: right">dI<em>max</em>lrv</td><td style="text-align: right"><code>1</code></td><td style="text-align: right">Larval maximum specific ingestion rate</td></tr><tr><td style="text-align: right">dI<em>max</em>juv</td><td style="text-align: right"><code>1</code></td><td style="text-align: right">Juvenile/adult maximum specific ingestion rate</td></tr><tr><td style="text-align: right">kappa_emb</td><td style="text-align: right"><code>0.8</code></td><td style="text-align: right">Embryonic to metamorph allocation fraction</td></tr><tr><td style="text-align: right">kappa_juv</td><td style="text-align: right"><code>0.8</code></td><td style="text-align: right">Juvenile/adult allocation fraction to soma</td></tr><tr><td style="text-align: right">gamma</td><td style="text-align: right"><code>0.5</code></td><td style="text-align: right">Larval allocation to metamorphic reserves</td></tr><tr><td style="text-align: right">eta_IA</td><td style="text-align: right"><code>0.54</code></td><td style="text-align: right">Assimilation efficiency</td></tr><tr><td style="text-align: right">eta<em>AS</em>emb</td><td style="text-align: right"><code>0.4</code></td><td style="text-align: right">Embryonic growth efficiency</td></tr><tr><td style="text-align: right">eta<em>AS</em>juv</td><td style="text-align: right"><code>0.4</code></td><td style="text-align: right">Juvenile/adult growth efficiency</td></tr><tr><td style="text-align: right">eta_AR</td><td style="text-align: right"><code>0.95</code></td><td style="text-align: right">Reproduction efficiency</td></tr><tr><td style="text-align: right">eta_SA</td><td style="text-align: right"><code>0.8</code></td><td style="text-align: right">Shrinking efficiency</td></tr><tr><td style="text-align: right">k<em>M</em>emb</td><td style="text-align: right"><code>0.11</code></td><td style="text-align: right">Embryonic somatic maintenance rate</td></tr><tr><td style="text-align: right">k<em>M</em>juv</td><td style="text-align: right"><code>0.11</code></td><td style="text-align: right">Juvenile/adult somatic maintenance rate</td></tr><tr><td style="text-align: right">k<em>J</em>emb</td><td style="text-align: right"><code>0.027</code></td><td style="text-align: right">Embryonic maturity maintenance rate</td></tr><tr><td style="text-align: right">k<em>J</em>juv</td><td style="text-align: right"><code>0.027</code></td><td style="text-align: right">Juvenile/adult maturity maintenance rate</td></tr><tr><td style="text-align: right">H_j1</td><td style="text-align: right"><code>1</code></td><td style="text-align: right">Maturity at start of metamorphosis</td></tr><tr><td style="text-align: right">H_p</td><td style="text-align: right"><code>55.</code></td><td style="text-align: right">Maturity at puberty</td></tr><tr><td style="text-align: right">T_A</td><td style="text-align: right"><code>8000.</code></td><td style="text-align: right">Arrhenius temperature (K)</td></tr><tr><td style="text-align: right">T_ref</td><td style="text-align: right"><code>293.15</code></td><td style="text-align: right">Reference temperature</td></tr><tr><td style="text-align: right">b_T</td><td style="text-align: right"><code>40.</code></td><td style="text-align: right">Temperature effect on resource allocation (cf. <a href="https://www.sciencedirect.com/science/article/pii/S0304380024003247">Romoli et al. (2025)</a>)</td></tr><tr><td style="text-align: right"><strong>TKTD Parameters</strong></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">h_b</td><td style="text-align: right"><code>0.</code></td><td style="text-align: right">Background mortality</td></tr><tr><td style="text-align: right">KD</td><td style="text-align: right"><code>[0. 0. 0. 0. 0. 0. 0.;]</code></td><td style="text-align: right">k_D per PMoA and stressor</td></tr><tr><td style="text-align: right">B</td><td style="text-align: right"><code>[2. 2. 2. 2. 2. 2. 2.;]</code></td><td style="text-align: right">Slope parameters</td></tr><tr><td style="text-align: right">E</td><td style="text-align: right"><code>[1e10 1e10 1e10 1e10 1e10 1e10 1e10;]</code></td><td style="text-align: right">Median effective damage per stressor and PMoA</td></tr><tr><td style="text-align: right">KD_h</td><td style="text-align: right"><code>[0.;]</code></td><td style="text-align: right">k_D for GUTS-SD module per stressor</td></tr><tr><td style="text-align: right">E_h</td><td style="text-align: right"><code>[1e10;]</code></td><td style="text-align: right">Sensitivity for GUTS-SD</td></tr><tr><td style="text-align: right">B_h</td><td style="text-align: right"><code>[1.;]</code></td><td style="text-align: right">Slope for GUTS-SD</td></tr><tr><td style="text-align: right">C_h</td><td style="text-align: right"><code>[1.;]</code></td><td style="text-align: right">Proportionqlity constant to convert larval sublethal response to post-metamorphic hazard rate</td></tr><tr><td style="text-align: right">S<em>rel</em>crit</td><td style="text-align: right"><code>0.66</code></td><td style="text-align: right">Critical relative body mass loss</td></tr><tr><td style="text-align: right">h_S</td><td style="text-align: right"><code>0.6</code></td><td style="text-align: right">Hazard rate below critical mass</td></tr><tr><td style="text-align: right">a_max</td><td style="text-align: right"><code>truncated(Normal(15*365, 1.5*365), 0, Inf)</code></td><td style="text-align: right">Maximum age [d]</td></tr><tr><td style="text-align: right">tau_R</td><td style="text-align: right"><code>365.</code></td><td style="text-align: right">Reproduction period [d]</td></tr><tr><td style="text-align: right"><strong>Pathogen effects</strong></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">Chi</td><td style="text-align: right"><code>LogNormal(log(1)+1^2, 1)</code></td><td style="text-align: right">Killing rate modifier (log-normal with mode 1, σ=1)</td></tr><tr><td style="text-align: right">E_P</td><td style="text-align: right"><code>[Inf, Inf, Inf, Inf]</code></td><td style="text-align: right">Sensitivity thresholds for pathogen effects</td></tr><tr><td style="text-align: right">B_P</td><td style="text-align: right"><code>[2., 2., 2., 2.]</code></td><td style="text-align: right">Slope parameters for pathogen effects</td></tr></table><h3 id="Pathogens-(pth)"><a class="docs-heading-anchor" href="#Pathogens-(pth)">Pathogens (<code>pth</code>)</a><a id="Pathogens-(pth)-1"></a><a class="docs-heading-anchor-permalink" href="#Pathogens-(pth)" title="Permalink"></a></h3><p>The model is adopted from <a href="https://royalsocietypublishing.org/doi/full/10.1098/rsif.2017.0480">Drawert et al. (2017)</a>. Default values are the averages of the suggested ranges.</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Default value</th><th style="text-align: right">Comment</th></tr><tr><td style="text-align: right">gamma</td><td style="text-align: right"><code>geomean([1e-6, 1.])</code></td><td style="text-align: right">Zoospore encounter rate [<code>spores individual⁻¹ d⁻¹</code>]</td></tr><tr><td style="text-align: right">eta</td><td style="text-align: right"><code>harmmean([5., 20.])</code></td><td style="text-align: right">Zoospore production rate</td></tr><tr><td style="text-align: right">v0</td><td style="text-align: right"><code>0.5</code></td><td style="text-align: right">Zoospore encystment rate</td></tr><tr><td style="text-align: right">f</td><td style="text-align: right"><code>0.5</code></td><td style="text-align: right">Host reinfection fraction</td></tr><tr><td style="text-align: right">sigma0</td><td style="text-align: right"><code>harmmean([0.1, 0.5])</code></td><td style="text-align: right">Sporangia killing rate</td></tr><tr><td style="text-align: right">sigma1</td><td style="text-align: right"><code>harmmean([0.1, 0.5])</code></td><td style="text-align: right">Density-dependent killing rate</td></tr><tr><td style="text-align: right">mu</td><td style="text-align: right"><code>harmmean([0.01, 1.5])</code></td><td style="text-align: right">Zoospore death rate</td></tr></table><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.AmphiDEB_ODE_with_linear_TD!-NTuple{4, Any}" href="#AmphiDEB.AmphiDEB_ODE_with_linear_TD!-NTuple{4, Any}"><code>AmphiDEB.AmphiDEB_ODE_with_linear_TD!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AmphiDEB_ODE_with_linear_TD!(du, u, p, t)::Nothing</code></pre><p>ODE system with linear toxicodynamics. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.AmphiDEB_ODE_with_loglogistic_TD!-NTuple{4, Any}" href="#AmphiDEB.AmphiDEB_ODE_with_loglogistic_TD!-NTuple{4, Any}"><code>AmphiDEB.AmphiDEB_ODE_with_loglogistic_TD!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AmphiDEB_ODE_with_loglogistic_TD!(du, u, p, t)::Nothing</code></pre><p>ODE system with log-logistic toxicodynamics. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.AmphiDEB_global_rules!-Tuple{Any}" href="#AmphiDEB.AmphiDEB_global_rules!-Tuple{Any}"><code>AmphiDEB.AmphiDEB_global_rules!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AmphiDEB_global_rules!(m)</code></pre><p>Global rule-based portion of the AmphiDEB IBM. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/global_rules.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.Amphibian_DEB!-NTuple{4, Any}" href="#AmphiDEB.Amphibian_DEB!-NTuple{4, Any}"><code>AmphiDEB.Amphibian_DEB!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Amphibian_DEB!(du, u, p, t)::Nothing</code></pre><p>The default amphibian DEB model assumes a metamorphic reserve compartment, which is accumulated during larval development, and depleted during metamorphosis.  During metamorphosis, ingestion rate decreases gradually and reaches 0 at the end of metamorphosis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L58-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.IBM_simulator-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.IBM_simulator-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.IBM_simulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IBM_simulator(
    p::ComponentVector;

    init_global_statevars = initialize_global_statevars,
    global_ode! = AmphiDEB_global!,
    global_rules! = AmphiDEB_global_rules!,
    
    init_individual_statevars = initialize_individual_statevars,
    individual_ode! = AmphiDEB_individual_ODE_with_loglogistic_TD!, 
    individual_rules! = default_individual_rules!,
    gen_ind_params = p -&gt; EcotoxSystems.generate_individual_params(p; pth = p.pth),

    kwargs...
    )</code></pre><p>Compose and execute an individual-based simulation from the given components. &lt;br&gt; This function is a simple wrapper around <code>EcotoxSystems.IBM_simulator</code>. &lt;br&gt; Its main purpose is to provide a default configuration for the <code>AmphiDEB</code> model. </p><p><strong>Positional arguments</strong></p><ul><li><code>p</code>: Parameters for all components: global (<code>p.glb</code>), Amphibian species-specific (<code>p.spc</code>) and pathogen-specific (<code>p.pth</code>)</li></ul><p><strong>Keyword arguments</strong></p><p><strong>Specification of global part of the system</strong></p><ul><li><code>init_global_statevars</code>: Function that initializes global state variables as <code>ComponentVector</code>, e.g. food abundance, temperature. </li><li><code>global_ode!</code>: Defintion of global ODE-based portion of the system (e.g. growth or experimental addition of food resource).</li><li><code>global_rules!</code>: Definition of global rule-based portion of the system (e.g. computing population aggregates).</li></ul><p><strong>Specification of species/individual-specific part of the system</strong></p><ul><li><code>init_individual_statevars</code>: Function that initializes individual-level state variables as <code>ComponentVector</code>, e.g. structural mass, scaled adamge, etc.</li><li><code>individual_ode!</code>: Definition of individual-level ODE-based portion of the system (e.g. derivatives of the DEB-TKTD module).</li><li><code>individual_rules!</code>: Definition of individual-level rule-based portion of the system (e.g. death, discrete reproduction events).</li><li><code>gen_ind_params</code>: A function that converts species-specific parameters to individual-specific parameters. For parameters which are provided as distributions, this takes a random sample from the distribution each time an individual is generated. </li></ul><p>This argument probably does not have to be changed, unless additional components (other than <code>glb</code>, <code>spc</code> and <code>pth</code>) are added to the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/simulators.jl#L33-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.ODE_simulator-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.ODE_simulator-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.ODE_simulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ODE_simulator(
    p::ComponentVector; 
    model = AmphiDEB_ODE_M1!, 
    callbacks = AmphODE_callbacks(), 
    statevars_init = initialize_statevars,
    kwargs...
    )</code></pre><p>A wrapper around the <code>EcotoxSystems.jl</code> ODE_simulator  for application with the AmphiDEB model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/simulators.jl#L2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.TKTD_LL2!-NTuple{4, Any}" href="#AmphiDEB.TKTD_LL2!-NTuple{4, Any}"><code>AmphiDEB.TKTD_LL2!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TKTD_LL2!(du, u, p, t)::Nothing</code></pre><p>TKTD model with following configuration: </p><ul><li>Mixture toxicity based on independent action (IA)</li><li>Log-logistic relationship between damage and metabolic processes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L288-L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.TKTD_linear!-NTuple{4, Any}" href="#AmphiDEB.TKTD_linear!-NTuple{4, Any}"><code>AmphiDEB.TKTD_linear!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TKTD_linear!(du, u, p, t)::Nothing</code></pre><p>TKTD model with following configuration: </p><ul><li>Mixture toxicity based on independent action (IA)</li><li>Linear-above-threshold relationship between damage and metabolic processes (the default DEBtox stress function)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L327-L334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_H_eq_juv-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.calc_H_eq_juv-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.calc_H_eq_juv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_H_eq_juv(spc::ComponentVector)</code></pre><p>Calculate equilibrium maturity for juvenile/adult stages. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L96-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_H_eq_lrv-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.calc_H_eq_lrv-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.calc_H_eq_lrv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_H_eq_lrv(spc::ComponentVector)</code></pre><p>Calculate equilibrium maturity for larval stage. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_S_B-Tuple{DataFrames.AbstractDataFrame}" href="#AmphiDEB.calc_S_B-Tuple{DataFrames.AbstractDataFrame}"><code>AmphiDEB.calc_S_B</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_S_B(sim::AbstractDataFrame)</code></pre><p>Extracts structural mass at birth from simulation output. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_S_max_ad-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.calc_S_max_ad-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.calc_S_max_ad</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_S_max_ad(spc::ComponentVector)</code></pre><p>Alias for <code>calc_S_max_juv</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_S_max_juv-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.calc_S_max_juv-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.calc_S_max_juv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_S_max_juv(spc::ComponentVector)</code></pre><p>Calculates maximum structural mass of juveniles and adults from parameters. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_a_B-Tuple{DataFrames.AbstractDataFrame}" href="#AmphiDEB.calc_a_B-Tuple{DataFrames.AbstractDataFrame}"><code>AmphiDEB.calc_a_B</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_a_B(sim::AbstractDataFrame)</code></pre><p>Extracts age at birth from simulation output. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_a_j1-Tuple{DataFrames.AbstractDataFrame}" href="#AmphiDEB.calc_a_j1-Tuple{DataFrames.AbstractDataFrame}"><code>AmphiDEB.calc_a_j1</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_a_j1(sim::AbstractDataFrame)</code></pre><p>Extract age at beginning of metamorphosis, <code>j1</code>, from simulation output. &lt;br&gt; Beginning of metamorphosis is defined as the point when feeding rates start to decline. &lt;br&gt; This can align with Gosner stage 42 for amphibians, but can also be as early as Gosner 38.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L33-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_a_j2-Tuple{DataFrames.AbstractDataFrame}" href="#AmphiDEB.calc_a_j2-Tuple{DataFrames.AbstractDataFrame}"><code>AmphiDEB.calc_a_j2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_a_j2(sim::AbstractDataFrame)</code></pre><p>Extract age at the end of metamorphosis, based on depletion of metamorphic reserve. &lt;br&gt; Without providing an additional maturity threshold (and therefore an additional argument to this function),  this is the only plausible option we currently have.&lt;br&gt; In that case, the end of metamorphosis is reached when the reserve is depleted.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L45-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_a_j2-Union{Tuple{R}, Tuple{DataFrames.AbstractDataFrame, R}} where R&gt;:Real" href="#AmphiDEB.calc_a_j2-Union{Tuple{R}, Tuple{DataFrames.AbstractDataFrame, R}} where R&gt;:Real"><code>AmphiDEB.calc_a_j2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_a_j2(sim::AbstractDataFrame, H_j2)</code></pre><p>Extract age at the end of metamorphosis, based on a maturity threshold <code>H_j2</code>. &lt;br&gt;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L57-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dE_mt_lrv-NTuple{7, Float64}" href="#AmphiDEB.calc_dE_mt_lrv-NTuple{7, Float64}"><code>AmphiDEB.calc_dE_mt_lrv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dE_mt_lrv(
    eta_AS::Float64, 
    y_G::Float64,
    y_G_P::Float64,
    gamma::Float64,
    kappa::Float64,
    dA::Float64,
    dM::Float64
    )::Float64</code></pre><p>Accumulation of metamorphic reserve by larvae.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1111-L1123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dE_mt_mt-Tuple{Float64, Float64, Float64}" href="#AmphiDEB.calc_dE_mt_mt-Tuple{Float64, Float64, Float64}"><code>AmphiDEB.calc_dE_mt_mt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dE_mt_mt(
    dH::Float64,
    dJ::Float64,
    dM::Float64
    )::Float64</code></pre><p>Depletion of metamorphic reserve by metamorphs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1138-L1146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dH-Tuple{Float64, Float64, Float64}" href="#AmphiDEB.calc_dH-Tuple{Float64, Float64, Float64}"><code>AmphiDEB.calc_dH</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dH(
    kappa::Float64,
    dA::Float64,
    dJ::Float64
    )::Float64</code></pre><p>Maturation rate following standard DEBkiss model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1205-L1213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dH_mt-Tuple{Float64, Float64, Float64}" href="#AmphiDEB.calc_dH_mt-Tuple{Float64, Float64, Float64}"><code>AmphiDEB.calc_dH_mt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dH_mt(
    kappa::Float64,
    dM::Float64,
    dJ::Float64
    )::Float64</code></pre><p>Maturation rate for metamorphs, calculated from the κ-rule and assuming that soma are decoupled from the κ rule during metamorphosis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1224-L1232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dI_emb-NTuple{4, Float64}" href="#AmphiDEB.calc_dI_emb-NTuple{4, Float64}"><code>AmphiDEB.calc_dI_emb</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dI_emb(
    embryo::Float64,
    S::Float64,
    dI_max_emb::Float64,
    y_T::Float64
    )::Float64</code></pre><p>Embryonic buffer uptake rate for embryos.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L672-L681">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dI_juv-NTuple{6, Float64}" href="#AmphiDEB.calc_dI_juv-NTuple{6, Float64}"><code>AmphiDEB.calc_dI_juv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dI_juv(
    juvenile::Float64,
    adult::Float64,
    f_X::Float64,
    dI_max_juv::Float64,
    S::Float64,
    y_T::Float64
    )::Float64</code></pre><p>Food ingestion rate for juveniles and adults.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L744-L755">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dI_lrv-NTuple{5, Float64}" href="#AmphiDEB.calc_dI_lrv-NTuple{5, Float64}"><code>AmphiDEB.calc_dI_lrv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dI_lrv(
    larva::Float64,
    f_X::Float64,
    dI_max_lrv::Float64,
    S::Float64,
    y_T::Float64,
    )::Float64</code></pre><p>Food ingestion rate for larvae. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L720-L731">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dI_mt-NTuple{7, Float64}" href="#AmphiDEB.calc_dI_mt-NTuple{7, Float64}"><code>AmphiDEB.calc_dI_mt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dI_mt(
    metamorph::Float64,
    f_X::Float64,
    dI_max_lrv::Float64,
    E_mt::Float64,
    E_mt_max::Float64,
    S::Float64,
    y_T::Float64
    )::Float64</code></pre><p>Residual ingestion rate for metamorphs (if any). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L693-L705">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dS_emb_juv_ad-NTuple{7, Float64}" href="#AmphiDEB.calc_dS_emb_juv_ad-NTuple{7, Float64}"><code>AmphiDEB.calc_dS_emb_juv_ad</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dS_emb_juv_ad(
    kappa::Float64,
    dA::Float64,
    dM::Float64,
    eta_SA::Float64,
    y_G::Float64,
    y_GP::Float64,
    eta_AS::Float64
    )::Float64</code></pre><p>Somatic growth rate for embryos, juveniles and adults,  including response to chemicals (<code>y_G</code>) and pathogens (<code>y_GP</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L980-L993">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dS_lrv-NTuple{8, Float64}" href="#AmphiDEB.calc_dS_lrv-NTuple{8, Float64}"><code>AmphiDEB.calc_dS_lrv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dS_lrv(
    kappa::Float64,
    dA::Float64,
    dM::Float64,
    eta_SA::Float64,
    gamma::Float64,
    eta_AS::Float64,
    y_G::Float64,
    y_GP::Float64
    )::Float64</code></pre><p>Somatic growth rate for larvae.  Approach follows DEBkiss model, but with an additional γ-split to divert assimilates towards the metamorphic reserve.  This is also taken into account in the shrinking equation (<code>kappa * dA &lt; dM</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1013-L1028">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_dS_mt-NTuple{5, Float64}" href="#AmphiDEB.calc_dS_mt-NTuple{5, Float64}"><code>AmphiDEB.calc_dS_mt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_dS_mt(
    metamorph::Float64,
    eta_AS::Float64,
    y_G::Float64,
    y_GP::Float64,
    dA::Float64
    )::Float64</code></pre><p>Somatic growth rate for metamorphs. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1047-L1057">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_eta_AS-NTuple{7, Float64}" href="#AmphiDEB.calc_eta_AS-NTuple{7, Float64}"><code>AmphiDEB.calc_eta_AS</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_eta_AS(
    embryo::Float64,
    larva::Float64,
    metamorph::Float64,
    eta_AS_emb::Float64,
    juvenile::Float64,
    adult::Float64,
    eta_AS_juv::Float64
    )::Float64</code></pre><p>Individual&#39;s current value of the growth efficiency <code>eta_AS</code>,  based on life stage indicators and life stage-specific values of <code>eta_AS</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L513-L526">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_kappa-NTuple{11, Float64}" href="#AmphiDEB.calc_kappa-NTuple{11, Float64}"><code>AmphiDEB.calc_kappa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_kappa(
    embryo::Float64,
    larva::Float64,
    metamorph::Float64,
    kappa_emb::Float64,
    juvenile::Float64,
    adult::Float64,
    kappa_juv::Float64,
    b_T::Float64, 
    T_ref::Float64,
    y_K::Float64
    )::Float64</code></pre><p>Individual&#39;s current value of the growth efficiency <code>kappa</code>,  based on life stage indicators and life stage-specific values of <code>kappa</code>.</p><p>This includes temperature effects on κ as in Romoli et al. (2024).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L542-L560">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_metamorphosis_duration-Tuple{DataFrames.AbstractDataFrame}" href="#AmphiDEB.calc_metamorphosis_duration-Tuple{DataFrames.AbstractDataFrame}"><code>AmphiDEB.calc_metamorphosis_duration</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_metamorphosis_duration(sim::AbstractDataFrame)</code></pre><p>Calculate duration of metamorphosis. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L67-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.calc_vB_growthrate_lrv-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.calc_vB_growthrate_lrv-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.calc_vB_growthrate_lrv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_vB_growthrate_lrv(spc::ComponentVector)::Float64</code></pre><p>Calculate larval von Bertalanffy growth rate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/traits.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dA-NTuple{4, Float64}" href="#AmphiDEB.dA-NTuple{4, Float64}"><code>AmphiDEB.dA</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dA(
    dI::Float64, 
    eta_IA::Float64, 
    y_A::Float64, 
    y_AP::Float64
    )::Float64</code></pre><p>Assimilation flux, following standard DEBkiss model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L790-L799">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dE_mt-NTuple{4, Float64}" href="#AmphiDEB.dE_mt-NTuple{4, Float64}"><code>AmphiDEB.dE_mt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dE_mt(
    larva::Float64,
    dE_mt_lrv::Float64,
    metamorph::Float64,
    dE_mt_mt::Float64
    )::Float64</code></pre><p>Life stage-specific dynamics of the metamorphic reserve.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1157-L1166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dE_mt_max-Tuple{Float64, Float64}" href="#AmphiDEB.dE_mt_max-Tuple{Float64, Float64}"><code>AmphiDEB.dE_mt_max</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dE_mt_max(
    larva::Float64,
    dE_mt::Float64
    )::Float64</code></pre><p>Function to record the maximum metamorphic reserve level, reached at the transition from larva to metamorph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1178-L1185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dH-NTuple{4, Float64}" href="#AmphiDEB.dH-NTuple{4, Float64}"><code>AmphiDEB.dH</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dH(
    adult::Float64,
    metamorph::Float64,
    dH::Float64,
    dH_mt::Float64
    )::Float64</code></pre><p>Life stage-specific maturation rate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1243-L1252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dI-NTuple{4, Float64}" href="#AmphiDEB.dI-NTuple{4, Float64}"><code>AmphiDEB.dI</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dI(
    dI_emb::Float64,
    dI_mt::Float64, 
    dI_lrv::Float64, 
    dI_juv_ad::Float64
    )::Float64</code></pre><p>Food ingestion rate with account for life stage-specificity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L769-L778">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dJ-NTuple{5, Float64}" href="#AmphiDEB.dJ-NTuple{5, Float64}"><code>AmphiDEB.dJ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dM(
    S::Float64,
    k_M::Float64,
    y_M::Float64,
    y_MP::Float64,
    y_T::Float64
    )::Float64</code></pre><p>Maturity maintenance rates,  including response to chemicals (<code>y_M</code>), pathogens (<code>y_MP</code>) and temperature (<code>y_T</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L910-L921">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dM-NTuple{5, Float64}" href="#AmphiDEB.dM-NTuple{5, Float64}"><code>AmphiDEB.dM</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dM(
    S::Float64,
    k_M::Float64,
    y_M::Float64,
    y_MP::Float64,
    y_T::Float64
    )::Float64</code></pre><p>Somatic maintenance rate,  including response to chemicals (<code>y_M</code>), pathogens (<code>y_MP</code>) and temperature (<code>y_T</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L886-L897">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dP_S-NTuple{9, Float64}" href="#AmphiDEB.dP_S-NTuple{9, Float64}"><code>AmphiDEB.dP_S</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function dP_S(
    v0::Float64,
    gamma::Float64,
    P_Z::Float64,
    eta::Float64,
    f::Float64,
    P_S::Float64,
    sigma0::Float64,
    sigma1::Float64,
    Chi::Float64
    )::Float64</code></pre><p>Derivative of the individual-specific sporangia abundace <code>P_S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L180-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dP_Z-Tuple{Float64, Float64}" href="#AmphiDEB.dP_Z-Tuple{Float64, Float64}"><code>AmphiDEB.dP_Z</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function dP_Z(
    mu::Float64,
    P_Z::Float64
    )::Float64</code></pre><p>Derivative of the zoospore abundance <code>P_Z</code>. </p><p>This function does not take changes in zoopsore abundance due to infection into account.  This is handled in <code>Pathogen_Infection!</code>.</p><p>args: </p><ul><li><code>mu</code>: Zoospore background mortality rate</li><li><code>P</code>_Z`: Current zoospore abundance in the environment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L146-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dR-NTuple{7, Float64}" href="#AmphiDEB.dR-NTuple{7, Float64}"><code>AmphiDEB.dR</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dR(
    adult::Float64,
    eta_AR::Float64,
    y_R::Float64,
    y_RP::Float64,
    kappa::Float64,
    dA::Float64,
    dJ::Float64
    )::Float64</code></pre><p>Reproduction rate, including response to chemicals <code>y_R</code> and pathogens (<code>y_RP</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L946-L958">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.dS-NTuple{8, Float64}" href="#AmphiDEB.dS-NTuple{8, Float64}"><code>AmphiDEB.dS</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dS(
    embryo::Float64,
    juvenile::Float64,
    adult::Float64,
    dS_emb_juv_ad::Float64,
    larva::Float64,
    dS_lrv::Float64,
    metamorph::Float64,
    dS_mt::Float64
    )::Float64</code></pre><p>Life stage-specific somatic growth rate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L1071-L1084">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.determine_k_J-NTuple{7, Float64}" href="#AmphiDEB.determine_k_J-NTuple{7, Float64}"><code>AmphiDEB.determine_k_J</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_k_J(
    embryo::Float64,
    larva::Float64,
    metamorph::Float64,
    k_J_emb::Float64,
    juvenile::Float64,
    adult::Float64,
    k_J_juv::Float64
    )::Float64</code></pre><p>Current value of <code>k_J</code>, depending on life stage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L858-L870">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.determine_k_M-NTuple{7, Float64}" href="#AmphiDEB.determine_k_M-NTuple{7, Float64}"><code>AmphiDEB.determine_k_M</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_k_M(
    embryo::Float64,
    larva::Float64,
    metamorph::Float64,
    k_M_emb::Float64,
    juvenile::Float64,
    adult::Float64,
    k_M_juv::Float64
    )::Float64</code></pre><p>Current value of <code>k_M</code>, depending on life stage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L831-L843">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.determine_life_stage!-NTuple{4, Any}" href="#AmphiDEB.determine_life_stage!-NTuple{4, Any}"><code>AmphiDEB.determine_life_stage!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_life_stage!(du, u, p, t)::Nothing</code></pre><p>Determine an individual&#39;s current life stages by calculating all life stage indicators.  To avoid numerical issues during ODE solve, all life stage transitions are approximated by sigmoid functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L495-L501">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.f_X-Tuple{Float64, Float64, Float64, Float64, Vector{Float64}, Union{Vector{Float64}, Vector{Real}}, Float64, Float64}" href="#AmphiDEB.f_X-Tuple{Float64, Float64, Float64, Float64, Vector{Float64}, Union{Vector{Float64}, Vector{Real}}, Float64, Float64}"><code>AmphiDEB.f_X</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">f_X(
    larva::Float64,
    metamorph::Float64, 
    juvenile::Float64, 
    adult::Float64,
    X::Vector{Float64},
    V_patch::Union{Vector{Real},Vector{Float64}}, 
    K_X_lrv::Float64,
    K_X_juv::Float64
    )::Float64</code></pre><p>Scaled functional response with account for life stage-specific half saturation cosntant <code>K_X</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L642-L655">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.f_X-Tuple{Float64, Float64, Float64}" href="#AmphiDEB.f_X-Tuple{Float64, Float64, Float64}"><code>AmphiDEB.f_X</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">f_X(
    X::Float64,
    V_patch::Float64,
    K_X::Float64
    )::Float64</code></pre><p>Scaled functional response <code>f_X</code> based on Holling Type II functional response.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L622-L630">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.initialize_individual_statevars-Tuple{ComponentArrays.ComponentVector}" href="#AmphiDEB.initialize_individual_statevars-Tuple{ComponentArrays.ComponentVector}"><code>AmphiDEB.initialize_individual_statevars</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>&quot;     initialize<em>individual</em>statevars(p::ComponentVector; kwargs...)::ComponentVector</p><p>Initialize individual-level state variables for the AmhpiDEB model.  Additional states can be added via kwargs.  If existing states are provided via kwargs, these will be overwritten.</p><p><strong>IMPORTANT NOTE FOR SIMULATING MIXTURES</strong>:  You can simulate an arbitrary number of chemical stressors,  but it is currently not possible to dynamically change the shape of vectors and matrices contained in a <code>ComponentVector</code>.  In practice, this means: If you want to simulate mixtures, you cannot simply provide the parameters as kwargs to this function,  but the entire <code>ComponentVector</code> has to be re-defined.  You can do so by copy-pasting the definition body of this function and changing the shape of <code>y_j</code>.  The same is true for the parameter vector, where the shape of all TKTD parameters has to be adjusted.  An example is given in the unit tests of the <code>EcotoxSystems</code> package: https://github.com/SimonHansul/EcotoxSystems.jl/blob/main/test/test05_mixtures.jl For application to the AmphiDEB model, we have to take into account that it has an additional PMoA, and therefore an additional column in the sublethal TKTD parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/statevars.jl#L5-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.is_adult-Tuple{Float64, Float64}" href="#AmphiDEB.is_adult-Tuple{Float64, Float64}"><code>AmphiDEB.is_adult</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_adult(
    H::Float64,
    H_p::Float64;
    beta = 1e3
    )::Float64</code></pre><p>Determine wheter an individual is in adult state, returning life stage indicator as float. Adults are individuals with a maturity level above the puberty threshold <code>H_p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L474-L483">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.is_embryo-Tuple{Float64}" href="#AmphiDEB.is_embryo-Tuple{Float64}"><code>AmphiDEB.is_embryo</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_embryo(
    X_emb::Float64;
    beta::Float64 = 1e3
    )::Float64</code></pre><p>Determine whether an individual is in embryonic state, returning life stage indicator as float.  Following rules of the standard DEBkiss model, embryonic state is maintained until the embryonic buffer is emptied (<code>X_emb_int</code>=0).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L366-L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.is_juvenile-NTuple{6, Float64}" href="#AmphiDEB.is_juvenile-NTuple{6, Float64}"><code>AmphiDEB.is_juvenile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_juvenile(
    H::Float64,
    H_j1::Float64,
    y_H_neg::Float64,
    y_H_pos::Float64,
    E_mt::Float64,
    H_p::Float64;
    beta1 = 1e3,
    beta2 = 1e3,
    beta3 = 1e3
    )::Float64</code></pre><p>Determine wheter an individual is in juvenile state, returning life stage indicator as float. Juveniles are individuals with a maturity level between <code>H_j1</code> and <code>H_p</code> whose metamorphic reserve <code>E_mt</code>has been emptied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L442-L457">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.is_larva-NTuple{5, Float64}" href="#AmphiDEB.is_larva-NTuple{5, Float64}"><code>AmphiDEB.is_larva</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_larva(
    X_emb::Float64,
    H::Float64,
    H_j1::Float64,
    y_H_neg::Float64, 
    y_H_pos::Float64;
    beta1::Float64 = 1e3,
    beta2::Float64 = 1e7
    )::Float64</code></pre><p>Determine wheter an individual is in larval state, returning life stage indicator as float.  Larvae are all non-embryos whose maturity is below the threshold for metamorphosis <code>H_j1</code>.  The timing of <code>H_j1</code> will often be aligned with Gosner stage 42 for anurans, but might ocurr earlier.  The decisive factor is the decline in feeding rates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L384-L399">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.is_metamorph-NTuple{5, Float64}" href="#AmphiDEB.is_metamorph-NTuple{5, Float64}"><code>AmphiDEB.is_metamorph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_metamorph(
    H::Float64, 
    H_j1::Float64, 
    y_H_neg::Float64,
    y_H_pos::Float64,
    E_mt::Float64;
    beta1::Float64 = 1e7, 
    beta2::Float64 = 1e3, 
    )::Float64</code></pre><p>Determine wheter an individual is in metamorph state, returning life stage indicator as float. Metamorphs have a maturity level above `<code>H_j1</code>, and their metamorphic reserve <code>E_mt</code> is not emptied yet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L414-L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.life_stage_and_plasticity_effects-NTuple{4, Any}" href="#AmphiDEB.life_stage_and_plasticity_effects-NTuple{4, Any}"><code>AmphiDEB.life_stage_and_plasticity_effects</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">life_stage_and_plasticity_effects(du, u, p, t)::Tuple{Float64,Float64}</code></pre><p>Life-stage specificity of parameters., as well as plastic responses to environmental factors (e.g. effect of temperature on κ).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L581-L585">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.minimal_TK_aquatic-NTuple{4, Float64}" href="#AmphiDEB.minimal_TK_aquatic-NTuple{4, Float64}"><code>AmphiDEB.minimal_TK_aquatic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimal_TK_aquatic(
    larva::Float64,
    k_D::Float64, 
    C_W::Float64,
    D::Float64
    )::Float64</code></pre><p>Minimal TK model (no feedbacks) for aquatic exposure.  Only applies to larvae.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L266-L276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.temperature_sinusoidal-NTuple{4, Float64}" href="#AmphiDEB.temperature_sinusoidal-NTuple{4, Float64}"><code>AmphiDEB.temperature_sinusoidal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature_sinusoidal(t::Float64, T_max::Float64, T_min::Float64, t_peak ::Float64)::Float64</code></pre><p>Calculate seasonal fluctuations in temperature from a sinusoidal function. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L125-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AmphiDEB.y_T-Tuple{Float64, Float64, Float64}" href="#AmphiDEB.y_T-Tuple{Float64, Float64, Float64}"><code>AmphiDEB.y_T</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">y_T(
    T_A::Float64,
    T_ref::Float64,
    T::Float64
    )::Float64</code></pre><p>Temperature correction coefficient <code>y_T</code> according to Arrhenius equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/AmphiDEB/blob/2d82384790653df94983d960f8e5b93ee2418a92/src/derivatives.jl#L594-L602">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Monday 19 May 2025 10:27">Monday 19 May 2025</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
